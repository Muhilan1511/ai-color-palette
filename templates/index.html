<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Color Palette Moodboard - Mobile</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <nav class="navbar navbar-dark bg-dark sticky-top">
        <div class="container-fluid">
            <span class="navbar-brand mb-0 h1">ðŸŽ¨ Color Moodboard</span>
        </div>
    </nav>

    <div class="container-fluid main-container">
        <!-- Tab Navigation -->
        <ul class="nav nav-tabs nav-fill sticky-tabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="all-tab" data-bs-toggle="tab" data-bs-target="#all" type="button">
                    All Palettes
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="emotion-tab" data-bs-toggle="tab" data-bs-target="#emotion" type="button">
                    Select Emotion
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="upload-tab" data-bs-toggle="tab" data-bs-target="#upload" type="button">
                    Upload Image
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="qrcode-tab" data-bs-toggle="tab" data-bs-target="#qrcode" type="button">
                    QR Code
                </button>
            </li>
        </ul>

        <!-- Tab Content -->
        <div class="tab-content mt-4 pb-5">
            <!-- Tab 1: All Palettes -->
            <div class="tab-pane fade show active" id="all" role="tabpanel">
                <h2 class="section-title">All Emotion Palettes</h2>
                <div id="allPalettes" class="palettes-grid">
                    <!-- Loaded dynamically -->
                </div>
                <div class="export-buttons mt-4 mb-4">
                    <button class="btn btn-primary btn-sm me-2" onclick="exportAll('json')">ðŸ“¥ JSON</button>
                    <button class="btn btn-secondary btn-sm me-2" onclick="exportAll('csv')">ðŸ“„ CSV</button>
                    <button class="btn btn-info btn-sm" onclick="exportAll('txt')">ðŸ“‹ TXT</button>
                </div>
            </div>

            <!-- Tab 2: Select Emotion -->
            <div class="tab-pane fade" id="emotion" role="tabpanel">
                <h2 class="section-title">Select an Emotion</h2>
                <select id="emotionSelect" class="form-select form-select-lg mb-4">
                    <option value="">Choose an emotion...</option>
                </select>
                <div id="selectedEmotionPalette">
                    <!-- Loaded dynamically -->
                </div>
            </div>

            <!-- Tab 3: Upload Image -->
            <div class="tab-pane fade" id="upload" role="tabpanel">
                <h2 class="section-title">ðŸ“· Upload Image</h2>
                <div class="upload-area" id="uploadArea">
                    <input type="file" id="imageInput" accept="image/png,image/jpeg,image/jpg" class="d-none">
                    <div class="upload-content">
                        <p class="mb-2">ðŸ“¸</p>
                        <p class="mb-2">Tap to upload or drag image here</p>
                        <small class="text-muted">PNG or JPG, max 16MB</small>
                    </div>
                </div>

                <div id="uploadedImage" class="mt-3 d-none">
                    <img id="previewImage" src="" alt="Preview" class="img-fluid rounded mb-3">
                    <button class="btn btn-primary w-100" id="extractBtn">Extract Color Palette</button>
                </div>

                <div id="extractedResults" class="mt-4 d-none">
                    <h3>Extracted Colors</h3>
                    <div id="extractedPalette" class="palette-colors mb-4"></div>
                    
                    <div id="matchedSection" class="mt-4">
                        <h4>Best Match</h4>
                        <p id="matchedEmotion" class="emotion-match"></p>
                        <div id="matchedPalette" class="palette-colors"></div>
                    </div>

                    <div class="export-buttons mt-4">
                        <button class="btn btn-sm btn-primary me-2" onclick="exportExtracted('json')">ðŸ“¥ JSON</button>
                        <button class="btn btn-sm btn-secondary me-2" onclick="exportExtracted('csv')">ðŸ“„ CSV</button>
                        <button class="btn btn-sm btn-info" onclick="exportExtracted('css')">ðŸŽ¨ CSS</button>
                    </div>
                </div>

                <div id="loadingSpinner" class="d-none mt-4">
                    <div class="spinner-border text-primary" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                    <p class="mt-2">Analyzing image...</p>
                </div>
            </div>

            <!-- Tab 4: QR Code -->
            <div class="tab-pane fade" id="qrcode" role="tabpanel">
                <h2 class="section-title">ðŸ“± Share with QR Code</h2>
                <p class="text-muted mb-4">Scan this QR code on another device to access the app</p>
                
                <div id="qrcodeContainer" class="text-center">
                    <div class="spinner-border text-primary" role="status">
                        <span class="visually-hidden">Loading QR code...</span>
                    </div>
                    <p class="mt-2">Generating QR code...</p>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
